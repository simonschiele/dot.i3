# main modkeys
# I try to use the "super"-key for everything WM related.
# Sometimes in combination with Shift, Ctrl and/or Alt.
set $mod Mod4
set $alt Mod1

# commands
set $browser chromium
set $browser_incognito chromium --incognito
set $compositor compton --backend glx --vsync opengl -b
set $editor i3-sensible-editor
set $exit i3-msg exit
set $filer nautilus
set $lock i3lock -e -d -c 000022 && sleep 1
set $pager i3-sensible-pager
set $reboot systemctl reboot
set $reload i3-msg reload
set $restart i3-msg restart
set $screenshot gnome-screenshot -f ./screenshot-$(date +%Y-%m-%d_%s).png
set $screenshotui gnome-screenshot -i
set $shutdown systemctl poweroff -i
set $suspend2disk nop
set $suspend2ram systemctl suspend
set $terminal i3-sensible-terminal

# general settings
workspace_layout default
default_orientation horizontal
new_window 1pixel                # new tiling window - border
new_float 1pixel                 # new floating window - border
hide_edge_borders both           # <none|vertical|horizontal|both>
focus_follows_mouse yes
force_focus_wrapping yes         # not sure I want that anymore...
force_display_urgency_hint 1000 ms
floating_modifier $mod
floating_minimum_size 100 x 50
floating_maximum_size -1 x -1
font pango:DejaVu Sans Mono 8
# popup_during_fullscreen <smart|ignore|leave_fullscreen>
# mouse_warping <output|none>    # center cursor on window  # <output|none>
# force_xinerama <yes|no>

# kill window
bindsym $mod+x kill
bindsym $mod+Shift+x exec --no-startup-id xkill

# change focus
bindsym $mod+Left focus left
bindsym $mod+Down focus down
bindsym $mod+Up focus up
bindsym $mod+Right focus right
bindsym $mod+u [urgent=latest] focus

# baaad
# bindsym $mod+Tab focus right
# bindsym Control+Tab focus left

# move focused window
bindsym $mod+Shift+Left move left 20px
bindsym $mod+Shift+Down move down 20px
bindsym $mod+Shift+Up move up 20px
bindsym $mod+Shift+Right move right 20px

# split in horizontal/vertical orientation
bindsym $mod+h split h
bindsym $mod+v split v

# enter fullscreen mode for the focused container
bindsym $mod+f fullscreen

# toggle tiling / floating
bindsym $mod+Shift+f floating toggle

# change container layout (stacked, tabbed, toggle split)
bindsym $mod+w layout toggle
#bindsym $mod+s layout stacking
#bindsym $mod+w layout tabbed
#bindsym $mod+e layout toggle split

# change focus between tiling / floating windows
# bindsym $mod+space focus mode_toggle

# focus the parent container
#bindsym $mod+a focus parent

# focus the child container
#bindsym $mod+d focus child

# default workspace
#workspace 1 output VGA-1
#workspace 5 output DP-1
#workspace 10 output DP-2

#switch to workspace
bindsym $mod+1 workspace 1
bindsym $mod+2 workspace 2
bindsym $mod+3 workspace 3
bindsym $mod+4 workspace 4
bindsym $mod+5 workspace 5
bindsym $mod+6 workspace 6
bindsym $mod+7 workspace 7
bindsym $mod+8 workspace 8
bindsym $mod+9 workspace 9
bindsym $mod+0 workspace 10

# move f$modocused container to workspace
bindsym $mod+Shift+1 move container to workspace 1
bindsym $mod+Shift+2 move container to workspace 2
bindsym $mod+Shift+3 move container to workspace 3
bindsym $mod+Shift+4 move container to workspace 4
bindsym $mod+Shift+5 move container to workspace 5
bindsym $mod+Shift+6 move container to workspace 6
bindsym $mod+Shift+7 move container to workspace 7
bindsym $mod+Shift+8 move container to workspace 8
bindsym $mod+Shift+9 move container to workspace 9
bindsym $mod+Shift+0 move container to workspace 10

# workspace back+forth
workspace_auto_back_and_forth yes

# i3bar
bar {
    position top

    # I'm not convinced yet...
    # mode hide
    #rhidden_state hide

    status_command i3blocks -c ~/.config/i3/i3blocks.conf || \
                   i3status -c ~/.config/i3/i3status.conf

    tray_output LVDS-1
    tray_output primary
}

# launcher
bindsym $mod+e exec --no-startup-id dmenu_run # -nb red
#bindsym $mod+d exec --no-startup-id i3-dmenu-desktop

# SSH
bindsym $mod+s exec --no-startup-id $terminal -e ssh $( history | grep "[0-9]  ssh " | rev | cut -d' ' -f1 | rev | sort -u | dmenu -i -nb black -nf red -sb red -sf black -l 12 )

# applications
bindsym $mod+F2 exec --no-startup-id $lock
bindsym $mod+Return exec --no-startup-id $terminal
bindsym $mod+Shift+Return exec --no-startup-id $filer
bindsym $mod+BackSpace exec --no-startup-id $browser
bindsym $mod+Shift+BackSpace exec --no-startup-id $browser_incognito
bindsym $mod+m exec --no-startup-id gmpc-remote --toggle-view
bindsym $mod+p exec --no-startup-id $terminal -e "ipython"

# screenshot
bindsym Print exec --no-startup-id $screenshot
bindsym $mod+Print exec --no-startup-id $screenshotui
bindsym Shift+Print exec --no-startup-id $screenshotui

# multimedia keys
# bindsym XF86AudioLowerVolume exec --no-startup-id pactl set-sink-volume 0 -- -5%
# bindsym XF86AudioMute exec --no-startup-id pactl set-sink-mute 0 toggle
# bindsym XF86AudioNext nop
# bindsym XF86AudioPause nop
# bindsym XF86AudioPlay nop
# bindsym XF86AudioPrev nop
# bindsym XF86AudioRaiseVolume exec --no-startup-id pactl set-sink-volume 0 +5%
# bindsym XF86AudioStop nop
# bindsym XF86Back nop
# bindsym XF86Battery nop
# bindsym XF86Forward nop
# bindsym XF86MonBrightnessDown exec xbacklight -dec 20
# bindsym XF86MonBrightnessUp exec xbacklight -inc 20
# bindsym XF86TouchpadToggle nop
# bindsym XF86WLAN nop

# floating - generic and non-optional
for_window [window_role="pop-up"] floating enable
for_window [window_role="task_dialog"] floating enable
for_window [title="Complete Installation"] floating enable
for_window [title="Terminator Preferences"] floating enable
for_window [title="Android Studio Setup Wizard"] floating enable
for_window [class="(?i)notify"] floating enable border 1pixel

# floating - personal applications
for_window [class="(?i)qemu-system*"] floating enable
for_window [class="(?i)mplayer"] floating enable
for_window [class="(?i)mpv"] floating enable
for_window [class="(?i)gimp"] floating enable
for_window [class="(?i)gmrun"] floating enable
for_window [class="(?i)nautilus"] floating enable
for_window [class="(?i)thunar"] floating enable
for_window [class="(?i)pavucontrol"] floating enable
for_window [class="(?i)synergy"] floating enable
for_window [title="(?i)cinelerra*"] floating enable
for_window [title="(?i)wicd network manager"] floating enable
for_window [title="(?i)Android*Emulator*"] floating enable
for_window [title="(?i)Emulator*"] floating enable

# resize window mode
# use either mouse or switch to "resize mode" with win+r. In resize mode
# you can use cursor keys or hjkl to resize focused window
mode "resize" {
    bindsym Left resize shrink width 10 px or 10 ppt
    bindsym Down resize grow height 10 px or 10 ppt
    bindsym Up resize shrink height 10 px or 10 ppt
    bindsym Right resize grow width 10 px or 10 ppt

    bindsym h resize shrink width 10 px or 10 ppt
    bindsym j resize grow height 10 px or 10 ppt
    bindsym k resize shrink height 10 px or 10 ppt
    bindsym l resize grow width 10 px or 10 ppt

    # bindsym Shift-h resize shrink width 1 px or 1 ppt

    bindsym Return mode "default"
    bindsym Escape mode "default"
    bindsym BackSpace mode "default"
}
bindsym $mod+r mode "resize"

# system mode
# logout, reload, suspend, reboot, ...
set $mode_system System (l) lock, (q) quit/logout, (r) restart, (s) suspend, (mod+shift+r) reboot, (mod+shift+s) shutdown
mode "$mode_system" {
    bindsym l exec --no-startup-id $lock, mode "default"
    bindsym q exec $exit, mode "default"
    bindsym r exec $restart, mode "default"
    bindsym s exec --no-startup-id $suspend2ram, mode "default"
    bindsym $mod+Shift+r exec --no-startup-id $reboot, mode "default"
    bindsym $mod+Shift+s exec --no-startup-id $shutdown, mode "default"

    bindsym Return mode "default"
    bindsym Escape mode "default"
    bindsym BackSpace mode "default"
}
bindsym $mod+q mode "$mode_system"

# autostart (mostly replaced by systemd units)
exec --no-startup-id $compositor
